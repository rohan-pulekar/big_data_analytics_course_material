To get all nodes and relationships in the graph:
START n=node(*) MATCH (n)-[r]->(m) RETURN n,r,m;

To get actors:
MATCH (actor:Actor) return actor.name as name,actor.year_born as year_born;
and then export them to export_actor.csv

To get directors:
MATCH (director:Director) return director.name as name,director.year_born as year_born; 
and then export them to export_director.csv

To get movies:
MATCH (movie:Movie) return movie.title as title,movie.year as year;
and then export them to export_movie.csv

To get ACTS_IN relationship:
MATCH (actor:Actor)-[r:ACTS_IN]->(movie:Movie) return actor.name as actor_name, r.role as role, movie.title as movie_title;
and then export them to export_acts_in_relationship.csv

To get DIRECTED relationship:
MATCH (director:Director)-[r:DIRECTED]->(movie:Movie) return director.name as director_name, r.shooting_camera_setup as shooting_camera_setup,movie.title as movie_title;
and then export them to export_directed_relationship.csv


To delete all nodes and all relationships:
MATCH (n)
OPTIONAL MATCH (n)-[r]-()
DELETE n,r


To load movies from export_movie.csv:
LOAD CSV WITH HEADERS FROM "file:///Users/rpulekar/work/big-data-analytics-harvard/lectures_and_assignments/week-10-apr-8-2016/assignment/solution/database_exports/export_movie.csv" AS line MERGE (movie:Movie { title:line.title}) ON CREATE SET movie.year=line.year;

To load actors from export_actor.csv:
LOAD CSV WITH HEADERS FROM "file:///Users/rpulekar/work/big-data-analytics-harvard/lectures_and_assignments/week-10-apr-8-2016/assignment/solution/database_exports/export_actor.csv" AS line MERGE (a:Actor { name:line.name, year_born:line.year_born}) ON CREATE SET a.year_born=line.year_born;

To load directors from export_director.csv:
LOAD CSV WITH HEADERS FROM "file:///Users/rpulekar/work/big-data-analytics-harvard/lectures_and_assignments/week-10-apr-8-2016/assignment/solution/database_exports/export_director.csv" AS line MERGE (d:Director { name:line.name, year_born:line.year_born}) ON CREATE SET d.year_born=line.year_born;

To load ACTS_IN relationship from export_acts_in_relationship.csv:
LOAD CSV WITH HEADERS FROM "file:///Users/rpulekar/work/big-data-analytics-harvard/lectures_and_assignments/week-10-apr-8-2016/assignment/solution/database_exports/export_acts_in_relationship.csv" AS line FIELDTERMINATOR "," MERGE (m:Movie { title:line.movie_title }) MERGE (a:Actor { name:line.actor_name }) MERGE (a)-[:ACTS_IN { role:line.role}]->(m);

To load DIRECTED from export_directed_relationship.csv:
LOAD CSV WITH HEADERS FROM "file:///Users/rpulekar/work/big-data-analytics-harvard/lectures_and_assignments/week-10-apr-8-2016/assignment/solution/database_exports/export_directed_relationship.csv" AS line FIELDTERMINATOR "," MERGE (m:Movie { title:line.movie_title }) MERGE (d:Director { name:line.director_name }) MERGE (d)-[:DIRECTED { shooting_camera_setup:line.shooting_camera_setup}]->(m);


To see all nodes and relationships in the graph:
START n=node(*) MATCH (n)-[r]->(m) RETURN n,r,m;

